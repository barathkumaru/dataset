Hybrid Name Matcher (Person + Company)
You are a senior Python architect.

Design and implement a production-grade Hybrid Name Matcher that detects whether a given person name or company name appears in a paragraph.

The system must combine:

Deterministic rule-based matching

NLP-based entity validation

Structured name modeling

Confidence scoring

Safe input handling

Modular clean architecture

Use clean, scalable, maintainable Python code.

1Ô∏è‚É£ Functional Requirements
The system must expose:

match_person(name: str, paragraph: str) -> MatchResult
match_company(name: str, paragraph: str) -> MatchResult
Where MatchResult contains:

matched: bool

score: float (0.0‚Äì1.0)

method: str ("rule", "hybrid", "nlp", "none")

matched_phrase: Optional[str]

details: dict (debug metadata)

2Ô∏è‚É£ Architecture Requirements
Use modular design:

hybrid_name_matcher/
    normalizer.py
    models.py
    rule_matcher.py
    nlp_validator.py
    hybrid_matcher.py
    config.py
    main.py
Code must follow:

Single responsibility principle

Configurable thresholds

Clear separation of rule and NLP layers

No crash on None inputs

No global state

3Ô∏è‚É£ Input Handling Requirements
The system must:

Handle None safely

Handle empty strings

Handle non-string inputs

Never crash

Always return a valid MatchResult

If invalid input:
Return matched=False with score=0.0 and reason in details.

4Ô∏è‚É£ Normalization Requirements
Implement robust normalization:

Lowercase conversion

Unicode normalization (NFKD)

Accent removal

Remove punctuation

Collapse multiple spaces

Strip leading/trailing whitespace

Preserve token boundaries

Safe handling of email formats

Normalization must ensure:

"SACHIN TENDULK√ÅR!!!"
"sachin tendulkar"

5Ô∏è‚É£ Person Name Modeling
Create a structured PersonName model:

Fields:

first

middle (optional)

last

full_name

tokens

Support:

Middle names

Initials (M.S. Dhoni)

Hyphenated names (Jean-Luc Picard)

Extra whitespace

Case differences

6Ô∏è‚É£ Company Name Modeling
Create a structured CompanyName model:

Fields:

core_name

suffix (optional)

tokens

Recognize and strip legal suffixes:

ltd

limited

inc

llc

corp

corporation

pvt

plc

Core name must be used for matching.

Example:
"Infosys Limited"
‚Üí core_name = "infosys"

7Ô∏è‚É£ Rule-Based Matching Logic
Person Scoring
Use hierarchical scoring:

Exact full name substring ‚Üí 1.0

First + Last both present ‚Üí 0.9

Last name only ‚Üí 0.6

First name only ‚Üí 0.4

Fuzzy similarity ‚Üí dynamic (0.5‚Äì0.8)

No match ‚Üí 0.0

Must respect token boundaries.

Surname must be weighted higher than first name.

Company Scoring
Exact core name match ‚Üí 1.0

All core tokens present ‚Üí 0.9

Partial core match ‚Üí 0.6

Suffix-only match ‚Üí 0.0

No match ‚Üí 0.0

Do not match based on suffix alone.

8Ô∏è‚É£ Confidence Zones
Use 3 confidence zones:

High confidence (‚â• 0.85) ‚Üí return immediately

Medium confidence (0.5‚Äì0.85) ‚Üí escalate to NLP

Low confidence (< 0.5) ‚Üí reject

Threshold must be configurable via config.py.

9Ô∏è‚É£ NLP Validation Layer
Use spaCy or similar NER model.

For Person:

Validate in this order:

Full name entity

First + Last entity span

Structured token overlap

First name only (low weight fallback)

Must confirm:
Entity label = PERSON
Span overlaps expected tokens

Never accept first name alone if surname is absent unless strong contextual confidence.

For Company:

Validate:

ORG entity label

Span overlaps core company name

Full company mention preferred

Reject:
Generic words like "company", "organization".

üîü Hybrid Decision Logic
Final decision should combine:

Rule score
NLP score
Confidence weighting

Logic:

If rule score high ‚Üí accept
If medium + NLP confirms ‚Üí accept
Else ‚Üí reject

Do not allow weak rule + weak NLP to pass.

11Ô∏è‚É£ Edge Cases to Handle
Person:

Similar names (Sachin Pilot vs Sachin Tendulkar)

Shared surnames

Email mentions

Multiple people in paragraph

Accents

Extra whitespace

Hyphenated names

Initials

Company:

Legal suffix variations

Abbreviations

Multiple companies

Punctuation variations

Acronyms (e.g., TCS for Tata Consultancy Services)

12Ô∏è‚É£ Performance Requirements
Must operate in O(n) relative to paragraph length

Avoid repeated tokenization

Avoid unnecessary NLP calls

NLP should only trigger in medium-confidence zone

Efficient for long paragraphs

13Ô∏è‚É£ Testing Requirements
Create comprehensive test suite covering:

Positive cases
Negative cases
Neutral cases
Edge cases
Unicode cases
None cases
Multi-line paragraphs
Multiple entities

14Ô∏è‚É£ Output Expectations
Return:

MatchResult(
matched=True/False,
score=float,
method="rule" | "hybrid" | "nlp" | "none",
matched_phrase=str or None,
details=dict
)

Include debug metadata such as:

rule_score

nlp_score

reason

tokens matched

15Ô∏è‚É£ Code Quality Requirements
Type hints required

Docstrings required

Clean naming

No magic numbers

Config-driven thresholds

Proper logging

Clear comments

Production-ready structure

16Ô∏è‚É£ Deliverable
Generate:

Complete modular Python implementation

Configurable thresholds

Sample main.py runner

Sample test suite

Clear comments explaining logic

No pseudo-code

Fully runnable

